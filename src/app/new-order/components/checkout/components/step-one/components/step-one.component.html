<form
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
  *tuiLet="activeTabIndex$ | async as activeTabIndex"
>
  <tui-loader [showLoader]="false">
    <tui-tabs
      [activeItemIndex]="activeTabIndex"
      (activeItemIndexChange)="setActiveTabIndex($event)"
      class="mb-8"
    >
      <button tuiTab>Физическое лицо</button>
      <button tuiTab>Юридическое лицо</button>
    </tui-tabs>
  </tui-loader>
  <fieldset
    *ngIf="activeTabIndex === 0"
    [formGroup]="person"
    [patchFormGroupValues]="personValues$ | async"
    class="grid grid-cols-3 gap-x-5 gap-y-4"
  >
    <label class="mb-3 block">
      <span class="mb-1 inline-block text-xs">
        Фамилия
        <sup
          class="text-red"
          *ngIf="
            form.get('person.lastName').errors &&
            form.get('person.lastName').hasError('required')
          "
          >*</sup
        >
      </span>
      <tui-input
        tuiTextfieldSize="m"
        formControlName="lastName"
        [tuiTextfieldLabelOutside]="true"
      >
        <input tuiTextfield type="text" />
      </tui-input>
      <tui-error
        formControlName="lastName"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
    <label class="mb-3 block">
      <span class="mb-1 inline-block text-xs">
        Имя
        <sup
          class="text-red"
          *ngIf="
            form.get('person.firstName').errors &&
            form.get('person.firstName').hasError('required')
          "
          >*</sup
        >
      </span>
      <tui-input
        tuiTextfieldSize="m"
        formControlName="firstName"
        [tuiTextfieldLabelOutside]="true"
      >
        <input tuiTextfield type="text" />
      </tui-input>
      <tui-error
        formControlName="firstName"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
    <label class="mb-3 block">
      <span class="mb-1 inline-block text-xs">
        Отчество
        <sup
          class="text-red"
          *ngIf="
            form.get('person.middleName').errors &&
            form.get('person.middleName').hasError('required')
          "
          >*</sup
        >
      </span>
      <tui-input
        tuiTextfieldSize="m"
        formControlName="middleName"
        [tuiTextfieldLabelOutside]="true"
      >
        <input tuiTextfield type="text" />
      </tui-input>
      <tui-error
        formControlName="middleName"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
    <label class="mb-3 block">
      <span class="mb-1 inline-block text-xs">
        Email
        <sup
          class="text-red"
          *ngIf="
            form.get('person.email').errors &&
            form.get('person.email').hasError('required')
          "
          >*</sup
        >
      </span>
      <tui-input
        tuiTextfieldSize="m"
        formControlName="email"
        [tuiTextfieldLabelOutside]="true"
      >
        <input tuiTextfield type="email" />
      </tui-input>
      <tui-error
        formControlName="email"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
    <label class="mb-3 block">
      <span class="mb-1 inline-block text-xs">
        Телефон
        <sup
          class="text-red"
          *ngIf="
            form.get('person.phone').errors &&
            form.get('person.phone').hasError('required')
          "
          >*</sup
        >
      </span>
      <tui-input-phone
        formControlName="phone"
        tuiTextfieldSize="m"
        [tuiTextfieldLabelOutside]="true"
      >
        <input tuiTextfield autocomplete="tel" />
      </tui-input-phone>
      <tui-error
        formControlName="phone"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
    <label class="mb-3 block">
      <span class="mb-1 inline-block text-xs">
        Роль
        <sup
          class="text-red"
          *ngIf="
            form.get('person.role').errors &&
            form.get('person.role').hasError('required')
          "
          >*</sup
        >
      </span>
      <tui-select
        tuiTextfieldSize="m"
        formControlName="role"
        [tuiTextfieldLabelOutside]="true"
      >
        <tui-data-list-wrapper
          *tuiDataList
          [items]="roles"
        ></tui-data-list-wrapper>
      </tui-select>
      <tui-error
        formControlName="role"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
  </fieldset>
  <fieldset *ngIf="activeTabIndex === 1"></fieldset>

  <div *ngIf="activeTabIndex !== -1" class="mt-5 grid grid-cols-3 gap-x-5">
    <button
      [routerLink]="['/new-order', 'checkout', '1']"
      tuiButton
      size="m"
      [disabled]="this.form.invalid"
      class="col-start-3 w-full"
    >
      Дальше
    </button>
  </div>
</form>
